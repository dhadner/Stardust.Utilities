// <auto-generated>
// This code was generated by Stardust.Generators source generator.
// </auto-generated>
#nullable enable
using System;
using System.Buffers.Binary;
using System.Runtime.CompilerServices;

namespace Stardust.Utilities.Tests;

public partial class BitFieldsViewTests
{
    public partial record struct IPv4UdpPacketView
    {
        private readonly Memory<byte> _data;
        private readonly byte _bitOffset;

        /// <summary>Minimum number of bytes required in the backing buffer.</summary>
        public const int SizeInBytes = 28;

        /// <summary>Creates a view over the specified memory buffer.</summary>
        /// <param name="data">The buffer to view. Must contain at least <see cref="SizeInBytes"/> bytes.</param>
        /// <exception cref="ArgumentException">The buffer is too short.</exception>
        public IPv4UdpPacketView(Memory<byte> data)
        {
            if (data.Length < SizeInBytes)
                throw new ArgumentException($"Buffer must contain at least {SizeInBytes} bytes, but was {data.Length}.", nameof(data));
            _data = data;
            _bitOffset = 0;
        }

        /// <summary>Creates a view over the specified byte array.</summary>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public IPv4UdpPacketView(byte[] data) : this(data.AsMemory()) { }

        /// <summary>Creates a view over a portion of the specified byte array.</summary>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public IPv4UdpPacketView(byte[] data, int offset) : this(data.AsMemory(offset)) { }

        /// <summary>Creates a sub-view at a bit offset within the specified memory buffer (used by nested views).</summary>
        internal IPv4UdpPacketView(Memory<byte> data, int bitOffset)
        {
            _data = data;
            _bitOffset = (byte)bitOffset;
        }

        /// <summary>Gets the underlying memory buffer.</summary>
        public Memory<byte> Data => _data;

        public partial global::Stardust.Utilities.Protocols.IPv4HeaderView Ip
        {
            [MethodImpl(MethodImplOptions.AggressiveInlining)]
            get => new global::Stardust.Utilities.Protocols.IPv4HeaderView(_data.Slice(0));
            [MethodImpl(MethodImplOptions.AggressiveInlining)]
            set { value.Data.Span.Slice(0, global::Stardust.Utilities.Protocols.IPv4HeaderView.SizeInBytes).CopyTo(_data.Span.Slice(0)); }
        }

        public partial global::Stardust.Utilities.Protocols.UdpHeaderView Udp
        {
            [MethodImpl(MethodImplOptions.AggressiveInlining)]
            get => new global::Stardust.Utilities.Protocols.UdpHeaderView(_data.Slice(20));
            [MethodImpl(MethodImplOptions.AggressiveInlining)]
            set { value.Data.Span.Slice(0, global::Stardust.Utilities.Protocols.UdpHeaderView.SizeInBytes).CopyTo(_data.Span.Slice(20)); }
        }

    }
}
